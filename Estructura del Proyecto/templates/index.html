{# ------------------------------------------ #}
{# Heredamos la plantilla base.html           #}
{# ------------------------------------------ #}
{% extends "base.html" %}

{# ------------------------------------------ #}
{# Definimos el t√≠tulo que se mostrar√° en la pesta√±a del navegador #}
{# ------------------------------------------ #}
{% block title %}Dashboard - Sistema de Parking{% endblock %}

{# ------------------------------------------ #}
{# Bloque principal de contenido de la p√°gina #}
{# ------------------------------------------ #}
{% block content %}
  <div class="container-fluid">
    
    {# T√≠tulo principal con estilos de Bootstrap #}
    <h2 class="mb-4 fw-bold text-primary text-center">
      üöó Sistema de Parking - Detector de Placas
    </h2>

    {# -------------------------------------------------- #}
    {# Secci√≥n 1: Subida de imagen para detecci√≥n de placa #}
    {# -------------------------------------------------- #}
    <div class="card shadow p-4 mb-4 mx-auto" style="max-width: 500px;">
      
      {# Formulario para subir imagen desde la PC #}
      {# method="POST": se env√≠an datos al servidor #}
      {# enctype="multipart/form-data": necesario para subir archivos #}
      <form method="POST" enctype="multipart/form-data">
        
        {# Campo de selecci√≥n de archivo (imagen del veh√≠culo) #}
        <div class="mb-3">
          <label for="file" class="form-label fw-semibold">Subir Imagen del Veh√≠culo</label>
          <input type="file" class="form-control" id="file" name="file" required />
        </div>

        {# Bot√≥n para enviar la imagen y ejecutar la detecci√≥n de la placa #}
        <button type="submit" class="btn btn-primary w-100 mb-2">
          Detectar Placa
        </button>
      </form>

      {# -------------------------------------------------- #}
      {# Secci√≥n 2: Bot√≥n para activar la c√°mara en tiempo real #}
      {# -------------------------------------------------- #}
      {# Este formulario env√≠a una petici√≥n GET a la ruta 'camara' #}
      <form action="{{ url_for('camara') }}" method="GET">
        <button type="submit" class="btn btn-success w-100">
          üì∑ Activar C√°mara
        </button>
      </form>
    </div>

    {# -------------------------------------------------- #}
    {# Secci√≥n 3: Resultado de la detecci√≥n de la placa   #}
    {# -------------------------------------------------- #}
    {# Esto solo se muestra si existe la variable 'placa' enviada desde Flask #}
    {% if placa %}
    <div class="card shadow p-4 text-center mx-auto" style="max-width: 500px;">
      
      {# Mensaje de √©xito indicando que se detect√≥ la placa #}
      <h4 class="text-success mb-3">‚úÖ Placa Detectada:</h4>

      {# Mostramos el n√∫mero de placa detectado #}
      <p class="display-6 fw-bold">{{ placa }}</p>

      {# Mostramos la imagen de la placa recortada que se guarda en static #}
      <img
        src="{{ url_for('static', filename='placa_recortada.jpg') }}"
        alt="Imagen de la placa detectada"
        class="img-fluid border border-2 border-success mt-3"
      />
    </div>
    {% endif %}

    {# -------------------------------------------------- #}
    {# Secci√≥n 4: Bot√≥n para ver el historial de registros guardados #}
    {# -------------------------------------------------- #}
    <div class="mt-4 text-center mx-auto" style="max-width: 500px;">
      <a href="{{ url_for('historial') }}" class="btn btn-outline-secondary w-100">
        üìã Ver Registros Guardados
      </a>
    </div>

  </div>
{% endblock %}
